<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Phê duyệt đề xuất #{{ proposal[0] }}</title>
    <style>
        body {font-family: Arial; background:#f5f5f5; padding:30px;}
        .box {max-width:900px; margin:auto; background:white; padding:35px; border-radius:12px; box-shadow:0 0 20px rgba(0,0,0,0.1);}
        h2 {color:#a41017; margin-top:0;}
        .info {background:#f8fbff; padding:15px; border-radius:8px; margin:15px 0;}
        label {font-weight:bold; color:#333;}
        select, button {padding:12px; font-size:16px; margin:10px 0;}
        .btn {padding:14px 28px; border:none; border-radius:8px; color:white; cursor:pointer; font-weight:bold;}
        .approve {background:#4caf50;}
        .reject {background:#f44336;}
        .back {color:#a41017; text-decoration:none; font-size:16px;}
        .bod-notice {background:#fff3e0; padding:15px; border-left:5px solid #ff9800; margin:15px 0; font-weight:bold;}
    </style>
</head>
<body>
<div class="box">
    <h2>Phê duyệt đề xuất #{{ proposal[0] }}</h2>
    <div class="info">
        <p><strong>Tiêu đề:</strong> {{ proposal[1] }}</p>
        <p><strong>Người lập:</strong> {{ proposal[9] }} ({{ proposal[3] }})</p>
        <p><strong>Ngày lập:</strong> {{ proposal[10] }}</p>
        <p><strong>Nguồn kinh phí:</strong> {{ proposal[6] or "—" }}</p>
        <p><strong>Tổng chi phí:</strong> 
            {% if proposal[13] > 0 %}{{ "{:,.0f}".format(proposal[13]) }} VND{% else %}—{% endif %}
        </p>
        <p><strong>Trạng thái hiện tại:</strong> 
            <span style="color:#ff9800; font-weight:bold;">Chờ duyệt</span>
        </p>
    </div>

    <form method="POST">
        {% if is_bod %}
            <div style="background:#e8f5e9; padding:18px; border-radius:8px; margin:20px 0; text-align:center; border:2px solid #4caf50;">
                <strong style="color:#2e7d32; font-size:20px;">BẠN LÀ BOD</strong><br>
                <span style="font-size:16px;">Sau khi bạn duyệt → Đề xuất sẽ được HOÀN TẤT ngay lập tức</span>
            </div>
        {% else %}
            <label>Chọn người phê duyệt tiếp theo <span style="color:red;">*</span>:</label>
            <select name="next_approver" required style="width:100%; padding:12px; font-size:16px;">
                <option value="" disabled selected>-- Chọn người tiếp theo --</option>
                {% for a in approvers %}
                <option value="{{ a }}">{{ a }}
                    {% if a.split(" - ")[0] in ["TRƯƠNG HUỆ KHƯƠNG", "NGUYỄN THỊ HUỆ"] %}
                         (BOD - Người duyệt cuối cùng)
                    {% endif %}
                </option>
                {% endfor %}
            </select>
            <div class="bod-notice">
                Nếu bạn chọn BOD → BOD sẽ là người duyệt cuối cùng<br>
                Sau khi BOD duyệt → đề xuất tự động thành "Đã duyệt"
            </div>
        {% endif %}

        <div style="margin-top:30px; text-align:center;">
            <button type="submit" name="decision" value="approve" class="btn approve" style="font-size:18px; padding:16px 40px;">
                {% if is_bod %}DUYỆT HOÀN TẤT (BOD){% else %}Duyệt & Chuyển tiếp{% endif %}
            </button>
            <button type="submit" name="decision" value="reject" class="btn reject" style="font-size:18px; padding:16px 40px;">
                Từ chối đề xuất
            </button>
        </div>
    </form>

    <hr style="margin:40px 0;">
    <div style="text-align:center;">
        <a href="{{ url_for('dashboard') }}" class="back">Quay lại trang chủ</a>
    </div>
</div>
</body>
</html>