<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Phê duyệt đề xuất #{{ proposal[0] }}</title>
    <style>
        body {font-family: Arial; background:#f5f5f5; padding:30px;}
        .box {max-width:900px; margin:auto; background:white; padding:35px; border-radius:12px; box-shadow:0 0 20px rgba(0,0,0,0.1);}
        h2 {color:#1976d2; margin-top:0;}
        .info {background:#f8fbff; padding:15px; border-radius:8px; margin:15px 0;}
        label {font-weight:bold; color:#333;}
        select, button {padding:12px; font-size:16px; margin:10px 0;}
        .btn {padding:14px 28px; border:none; border-radius:8px; color:white; cursor:pointer; font-weight:bold;}
        .approve {background:#4caf50;}
        .reject {background:#f44336;}
        .back {color:#1976d2; text-decoration:none; font-size:16px;}
    </style>
</head>
<body>
<div class="box">
    <h2>Phê duyệt đề xuất #{{ proposal[0] }}</h2>
    <div class="info">
        <p><strong>Tiêu đề:</strong> {{ proposal[1] }}</p>
        <p><strong>Người lập:</strong> {{ proposal[9] }} ({{ proposal[3] }})</p>
        <p><strong>Ngày lập:</strong> {{ proposal[10] }}</p>
        <p><strong>Nguồn kinh phí:</strong> {{ proposal[6] or "—" }}</p>
        <p><strong>Tổng chi phí:</strong> 
            {% if proposal[13] > 0 %}{{ "{:,.0f}".format(proposal[13]) }} VND{% else %}—{% endif %}
        </p>
        <p><strong>Trạng thái:</strong> 
            <span style="color:#ff9800; font-weight:bold;">
                {% if proposal[11] == 'Chờ duyệt cấp 2' %}Chờ duyệt cấp 2{% else %}Chờ duyệt cấp 1{% endif %}
            </span>
        </p>
    </div>

    <form method="POST">
        {% if not is_second_level %}
        <label>Chọn người phê duyệt tiếp theo:</label>
        <select name="next_approver" required style="width:100%;">
            <option value="" disabled selected>-- Chọn người duyệt tiếp --</option>
            {% for a in approvers %}
            <option value="{{ a }}">{{ a }}</option>
            {% endfor %}
        </select>
        {% else %}
        <p style="color:green; font-weight:bold; font-size:18px;">Bạn là người duyệt cuối cùng</p>
        {% endif %}

        <div style="margin-top:30px;">
            <button type="submit" name="decision" value="approve" class="btn approve">
                {% if is_second_level %}DUYỆT HOÀN TẤT{% else %}Duyệt & Chuyển cấp 2{% endif %}
            </button>
            <button type="submit" name="decision" value="reject" class="btn reject">
                Từ chối đề xuất
            </button>
        </div>
    </form>

    <hr>
    <a href="{{ url_for('dashboard') }}" class="back">Quay lại trang chủ</a>
</div>
</body>
</html>